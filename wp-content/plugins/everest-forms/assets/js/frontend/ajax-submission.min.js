jQuery(function(n){"use strict";n('form[data-ajax_submission="1"]').each(function(e,s){n(document).ready(function(){var a=n(s),o=a.find(".evf-submit"),e=a.find("[data-gateway*='stripe']");0<e.length&&0===e.children.length||o.on("click",function(e){var s=a.serializeArray();e.preventDefault(),a.trigger("focusout").trigger("change").trigger("submit");e=a.find(".evf-error:visible");0<e.length?n([document.documentElement,document.body]).animate({scrollTop:e.last().offset().top},800):(n(this).html(a.data("process-text")),s.push({name:"action",value:"everest_forms_ajax_form_submission"}),s.push({name:"security",value:everest_forms_ajax_submission_params.evf_ajax_submission}),n.ajax({url:everest_forms_ajax_submission_params.ajax_url,type:"POST",data:s}).done(function(e,s,r){var i,t=e.data&&e.data.redirect_url?e.data.redirect_url:"";if(t)return a.trigger("reset"),void(window.location=t);"success"===e.data.response||!0===e.success?(a.trigger("reset"),a.closest(".everest-forms").html('<div class="everest-forms-notice everest-forms-notice--success" role="alert">'+e.data.message+"</div>").focus()):(i=a.data("formid"),t=everest_forms_ajax_submission_params.error,r=(e=JSON.parse(r.responseText)).data.error,"string"==typeof e.data.message&&(t=e.data.message),a.closest(".everest-forms").find(".everest-forms-notice").remove(),a.closest(".everest-forms").prepend('<div class="everest-forms-notice everest-forms-notice--error" role="alert">'+t+"</div>").focus(),n(r).each(function(e,s){var t,a=Object.values(s)[0],r=!0;switch(Object.keys(s)[0]){case"signature":t=n("#"+("evf-signature-img-input-"+a));break;case"likert":r=!1,(t=n('[id^="'+("everest_forms-"+i+"-field_"+a+"_")+'"]')).each(function(e,s){var r=n(s).closest("tr.evf-"+i+"-field_"+a).find("th"),s="everest_forms[form_fields]["+a+"]["+(parseInt(r.closest("tr").index())+1)+"]";r.children().is("label")?r.children().find("#"+s).show():r.append('<label id="'+s+'" for="'+s+'" class="evf-error">'+everest_forms_ajax_submission_params.required+"</label>")});break;case"address":(t=n('[id^="'+("evf-"+i+"-field_"+a)+'"]')).each(function(e,s){var r=String(n(s).attr("id"));(r.includes("-container")||r.includes("-address2")||void 0!==n(s).val())&&t.splice(e,1)});break;default:t=n("#"+("evf-"+i+"-field_"+a))}t.addClass("evf-error"),t.attr("required",!0),t.attr("aria-invalid",!0),t.first().closest(".evf-field").addClass("everest-forms-invalid evf-has-error"),!0!==r||t.is("label")||t.after('<label id="'+t.attr("id")+'-error" class="evf-error" for="'+t.attr("id")+'">'+everest_forms_ajax_submission_params.required+"</label>").show()}),o.attr("disabled",!1).html(everest_forms_ajax_submission_params.submit))}).fail(function(){o.attr("disabled",!1).html(everest_forms_ajax_submission_params.submit),a.trigger("focusout").trigger("change"),a.closest(".everest-forms").find(".everest-forms-notice").remove(),a.closest(".everest-forms").prepend('<div class="everest-forms-notice everest-forms-notice--error" role="alert">'+everest_forms_ajax_submission_params.error+"</div>").focus()}).always(function(e){!(e.data&&e.data.redirect_url?e.data.redirect_url:"")&&n(".everest-forms-notice").length&&n([document.documentElement,document.body]).animate({scrollTop:n(".everest-forms-notice").offset().top},800)}))})})})});